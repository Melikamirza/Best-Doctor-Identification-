import pandas as pd

# -------------------- 1. ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏูโูุง (ูุงู ุฎุฑูุฌ ุจุง ูพุดโุจูโูุง) --------------------
df = pd.read_excel("data/ูุชุงุฌ_ูพุดโุจู_ุชฺฏโูุง.xlsx")  # โ ูุงู ุฎุฑูุฌ ูุฏู ูุจู

# ูุฑุถ ูโฺฉูู ุณุชููโูุง ูพุดโุจู ุจุง ูพุดููุฏ "ูพุดโุจู_" ูุณุชูุฏ
tag_columns = ['ุชูุถุญุงุช ู ูุดุงูุฑู ุฏูู', 'ุฒูุงู ุงูุชุธุงุฑ ฺฉู', 'ูุญุท ุชูุฒ ู ุขุฑุงู', 'ููุจุชุฏู ุขููุงู']
pred_columns = [f"ูพุดโุจู_{tag}" for tag in tag_columns]

# -------------------- 2. ูุญุงุณุจู ูุงูฺฏู ุชฺฏโูุง ุจุฑุง ูุฑ ุฏฺฉุชุฑ ุจุฑ ุงุณุงุณ ูพุดโุจูโูุง --------------------
doctor_scores = df.groupby("ูุงู")[pred_columns].mean().reset_index()

# ุงูุญุงู ุชุฎุตุต ุฏฺฉุชุฑ (ูุฑุถ: ูุฑ ุฏฺฉุชุฑ ฺฉ ุชุฎุตุต ุฏุงุฑุฏ)
doctor_specialty = df.groupby("ูุงู")["ุชุฎุตุต "].first().reset_index()
doctor_scores = doctor_scores.merge(doctor_specialty, on="ูุงู")

# -------------------- 3. ุงูุชุฎุงุจ ุจูุชุฑู ุฏฺฉุชุฑ ูุฑ ุชุฎุตุต --------------------
best_doctors = (
    doctor_scores
    .sort_values(by=pred_columns, ascending=False)
    .groupby("ุชุฎุตุต ")
    .head(1)
    .reset_index(drop=True)
)

# -------------------- 4. ููุงุด ุฎุฑูุฌ --------------------
print("\n๐ ุจูุชุฑู ุฏฺฉุชุฑูุง ุจุฑ ุงุณุงุณ ุชุญูู ูพุดโุจู ูุฏู:")
for _, row in best_doctors.iterrows():
    print(f"ุชุฎุตุต: {row['ุชุฎุตุต ']} โ ๐จโโ๏ธ {row['ูุงู']}")
    for col in pred_columns:
        tag = col.replace("ูพุดโุจู_", "")
        print(f"   ๐ท๏ธ {tag}: {row[col]:.2f}")
    print()